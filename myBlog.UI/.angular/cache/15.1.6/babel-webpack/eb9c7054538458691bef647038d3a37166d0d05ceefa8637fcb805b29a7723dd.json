{"ast":null,"code":"import { catchError, throwError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"ngx-toastr\";\nimport * as i2 from \"../services/user.service\";\nexport class ErrorInterceptor {\n  constructor(toastr, userService) {\n    this.toastr = toastr;\n    this.userService = userService;\n  }\n  intercept(request, next) {\n    return next.handle(request).pipe(catchError(error => {\n      if (error) {\n        switch (error.status) {\n          case 400:\n            this.handle400Error(error);\n            break;\n          case 401:\n            this.handle401Error(error);\n            break;\n          case 500:\n            this.handle500Error(error);\n            break;\n          default:\n            this.handleUnexpectedError(error);\n            break;\n        }\n      }\n      return throwError(error);\n    }));\n  }\n  handle400Error(error) {\n    if (!!error.error && Array.isArray(error.error)) {\n      let errorMessage = '';\n      for (const key in error.error) {\n        if (!!error.error[key]) {\n          const errorElement = error.error[key];\n          errorMessage = `${errorMessage}${errorElement.code} - ${errorElement.description}\\n`;\n        }\n      }\n      this.toastr.error(errorMessage, error.statusText);\n      console.log(error.error);\n    } else if (!!error?.error?.errors?.Content && typeof error.error.errors.Content === 'object') {\n      let errorObject = error.error.errors.Content;\n      let errorMessage = '';\n      for (const key in errorObject) {\n        const errorElement = errorObject[key];\n        errorMessage = `${errorMessage}${errorElement}\\n`;\n      }\n      this.toastr.error(errorMessage, error.statusCode);\n      console.log(error.error);\n    } else if (!!error.error) {\n      let errorMessage = typeof error.error === 'string' ? error.error : 'There was a validation error.';\n      this.toastr.error(errorMessage, error.statusCode);\n      console.log(error.error);\n    } else {\n      this.toastr.error(error.statusText, error.status);\n      console.log(error);\n    }\n  }\n  handle401Error(error) {\n    let errorMessage = 'Please login to your account.';\n    this.userService.logout();\n    this.toastr.error(errorMessage, error.statusText);\n    //  this.router.navigate(['/login']);\n  }\n\n  handle500Error(error) {\n    this.toastr.error('Please contact the administrator. An error happened in the server.');\n    console.log(error);\n  }\n  handleUnexpectedError(error) {\n    this.toastr.error('Something unexpected happened.');\n    console.log(error);\n  }\n}\nErrorInterceptor.ɵfac = function ErrorInterceptor_Factory(t) {\n  return new (t || ErrorInterceptor)(i0.ɵɵinject(i1.ToastrService), i0.ɵɵinject(i2.UserService));\n};\nErrorInterceptor.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ErrorInterceptor,\n  factory: ErrorInterceptor.ɵfac\n});","map":{"version":3,"mappings":"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","names":["catchError","throwError","ErrorInterceptor","constructor","toastr","userService","intercept","request","next","handle","pipe","error","status","handle400Error","handle401Error","handle500Error","handleUnexpectedError","Array","isArray","errorMessage","key","errorElement","code","description","statusText","console","log","errors","Content","errorObject","statusCode","logout","factory"],"sourceRoot":"","sources":["C:\\Users\\ACER\\Desktop\\myBlog\\myBlog.UI\\src\\app\\interceptors\\error.interceptor.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor\n} from '@angular/common/http';\nimport { catchError, Observable, throwError } from 'rxjs';\nimport { UserService } from '../services/user.service';\n//import { ToastrService } from 'ngx-toastr/public_api';\nimport  { ToastrService } from 'ngx-toastr';\n\n\n@Injectable()\nexport class ErrorInterceptor implements HttpInterceptor {\n\n  constructor(\n    private toastr : ToastrService,\n    private userService: UserService\n  ) {}\n\n  intercept(request: HttpRequest<unknown>, next: HttpHandler): Observable<HttpEvent<unknown>> {\n    return next.handle(request).pipe(\n      catchError(error=> {\n        if(error){\n          switch(error.status){\n            case 400:\n              this.handle400Error(error);\n              break;\n            \n            case 401:\n              this.handle401Error(error);\n              break;\n            case 500:\n              this.handle500Error(error);\n              break;\n            default:\n              this.handleUnexpectedError(error);\n               break;\n          }\n        }\n        return throwError(error);\n      })\n    );\n  }\n\n  handle400Error(error: any) {\n    if (!!error.error && Array.isArray(error.error)) {\n      let errorMessage = '';\n      for (const key in error.error) {\n        if (!!error.error[key]) {\n          const errorElement = error.error[key];\n          errorMessage = (`${errorMessage}${errorElement.code} - ${errorElement.description}\\n`);\n        }\n      }\n      this.toastr.error(errorMessage, error.statusText);\n      console.log(error.error);\n    } else if (!!error?.error?.errors?.Content && (typeof error.error.errors.Content) === 'object') {\n      let errorObject = error.error.errors.Content;\n      let errorMessage = '';\n      for (const key in errorObject) {\n        const errorElement = errorObject[key];\n        errorMessage = (`${errorMessage}${errorElement}\\n`);\n      }\n      this.toastr.error(errorMessage, error.statusCode);\n      console.log(error.error);\n    } else if (!!error.error) {\n      let errorMessage = ((typeof error.error) === 'string')\n        ? error.error\n        : 'There was a validation error.';\n      this.toastr.error(errorMessage, error.statusCode);\n      console.log(error.error);\n    } else {\n      this.toastr.error(error.statusText, error.status);\n      console.log(error);\n    }\n  }\n\n  handle401Error(error: any) {\n    let errorMessage = 'Please login to your account.';\n    this.userService.logout();\n    this.toastr.error(errorMessage, error.statusText);\n  //  this.router.navigate(['/login']);\n  }\n\n  handle500Error(error: any) {\n    this.toastr.error('Please contact the administrator. An error happened in the server.');\n    console.log(error);\n  }\n\n  handleUnexpectedError(error: any) {\n    this.toastr.error('Something unexpected happened.');\n    console.log(error);\n  }\n}\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}